# å¸¸è§é—®é¢˜

* [General åŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºâ€œfailed to clash core, logs are not available.â€]()
* [macOS æ— æ³•è®¾ç½® System Proxyï¼Œç³»ç»Ÿä»£ç†é¡¹ç›®ç°è‰²æ— æ³•æ›´æ”¹]()
* [Service Mode æ— æ³•å®‰è£…]()
* [macOS ç‰ˆæœ¬å¯åŠ¨è¦æ±‚æˆæƒ]()
* [macOS DMG å®‰è£…åæ— æ³•æ‰“å¼€ï¼Œæç¤ºæŸå]()
* [ç³»ç»Ÿä»£ç†è‡ªåŠ¨å…³é—­æˆ–æ‰“å¼€]()
* [General ç«¯å£æ˜¾ç¤ºä¸º 0]()
* [Killer ç³»åˆ—ç½‘å¡æ— æ³•å¼€å¯ TAP/TUN æ¨¡å¼]()
* [åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ system ä½œä¸º TUN stack æ—¶ï¼ŒClash ç½‘å¡æ— æ³•æ­£å¸¸å·¥ä½œ]()
* [åœ¨ Windows ç³»ç»Ÿä¸­ï¼ŒTUN æ¨¡å¼ä¸‹æ— æ³•ä½¿ç”¨çƒ­ç‚¹åˆ†äº«åŠŸèƒ½]()
* [è½¯ä»¶å¯åŠ¨æ—¶ï¼ŒTUN åˆ›å»ºç½‘å¡å¤±è´¥ï¼Œæç¤º Start Tun interface error: error creating interface: Cannot create a file when that file already exists.ï¼ˆWindowsï¼‰]()
* [ä¸ºä»€ä¹ˆæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬å Service Mode åé¢çš„åœ°çƒå˜çº¢äº†ï¼Ÿ]()

## Ubuntu Linux æ²¡æœ‰ç³»ç»Ÿä»£ç†æŒ‰é’®

* å‚è§ [åœ¨ Linux (Ubuntu) ä¸‹å¯ç”¨ç³»ç»Ÿä»£ç†](https://github.com/Z-Siqi/Clash-for-Windows_Chinese/wiki/%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B#%E5%9C%A8-linux-ubuntu-%E4%B8%8B%E5%90%AF%E7%94%A8%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%90%86)


## General åŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºâ€œfailed to clash core, logs are not available.â€

å°†å®‰è£…ç›®å½•æ·»åŠ åˆ°æ€æ¯’è½¯ä»¶ç™½åå•ã€‚

å¦‚ Windows Defender å¼€å¯ï¼Œåˆ™éœ€è¦å°†å®‰è£…ç›®å½•æ·»åŠ åˆ°æ’é™¤é¡¹ (opens new window)ä¸­

å¦‚ä¾ç„¶æ— æ³•å¯åŠ¨ï¼Œè¯·å°è¯•åˆ é™¤é…ç½®æ–‡ä»¶ç›®å½•ï¼ˆä¸€èˆ¬æ˜¯`C:\Users\<ç”¨æˆ·å>\.config\clash`ï¼‰

## macOS æ— æ³•è®¾ç½® System Proxyï¼Œç³»ç»Ÿä»£ç†é¡¹ç›®ç°è‰²æ— æ³•æ›´æ”¹

* è¿›å…¥è®¾ç½®
* é€‰æ‹©å®‰å…¨ä¸éšç§
* é€‰æ‹©é€šç”¨
* ç‚¹å‡»è§£é”æŒ‰é’®ï¼Œè¾“å…¥å¯†ç 
* ç‚¹å‡»é«˜çº§...
* å–æ¶ˆè®¿é—®ç³»ç»ŸèŒƒå›´çš„åå¥½è®¾ç½®éœ€è¦è¾“å…¥ç®¡ç†å‘˜å¯†ç é€‰é¡¹

## Service Mode æ— æ³•å®‰è£…

#### Windows

å…ˆç¡®å®šç³»ç»Ÿå®‰è£…äº†.NET framework runtime

ç„¶åå°è¯•æ‰‹åŠ¨å®‰è£…ï¼š

* æ‰“å¼€ `C:/Program Files` ç›®å½•ï¼Œæ–°å»º `Clash for Windows Service` ç›®å½•
* è¿›å…¥ å®‰è£…ç›®å½•`/resources/static/files/win/[x64|arm64|ia32]/service` ç›®å½•ï¼Œæ‹·è´é‡Œé¢ä¸¤ä¸ª exe æ–‡ä»¶åˆ° 1 ä¸­æ–°å»ºç›®å½•ä¸­
* è¿›å…¥ å®‰è£…ç›®å½•`/resources/static/files/win/common` ç›®å½•ï¼Œæ‹·è´ `service.yml` æ–‡ä»¶åˆ° 1 ä¸­æ–°å»ºç›®å½•ä¸­
* åœ¨ 1 ä¸­æ–°å»ºç›®å½•ä¸­ï¼Œä½¿ç”¨ç®¡ç†å‘˜æƒé™æ‰“å¼€ CMD æ‰§è¡Œä¸€ä¸‹å‘½ä»¤ï¼š
```
service.exe install
service.exe start
```

å¦‚æœ install æ—¶å‡ºç°å¦‚ä¸‹æç¤ºï¼š

```
Service with id 'Clash Core Service' already exists
To install the service, delete the existing one or change service Id in the configuration file
2022-09-26 09:37:32,316 FATAL - Unhandled exception
System.Exception: Installation failure: Service with id 'Clash Core Service' already exists
   at WinSW.Program.<Run>g__Install|2_0(<>c__DisplayClass2_0& )
   at WinSW.Program.Run(String[] argsArray, IWinSWConfiguration descriptor)
   at WinSW.Program.Main(String[] args)
System.Exception: Installation failure: Service with id 'Clash Core Service' already exists
   at WinSW.Program.<Run>g__Install|2_0(<>c__DisplayClass2_0& )
   at WinSW.Program.Run(String[] argsArray, IWinSWConfiguration descriptor)
   at WinSW.Program.Main(String[] args)
```

å¯ä»¥å…ˆæ‰§è¡Œï¼š

```
service.exe stop
service.exe uninstall
```

å¦‚æœå®‰è£…åï¼ŒService Mode manage é‡Œæ˜¾ç¤º active ä½†å›¾æ ‡æ˜¾ç¤ºçº¢è‰²ï¼Œå¯ä»¥è¿›å…¥ `Home Directory` ç®¡ç†å‘˜å¯åŠ¨ CMDï¼Œæ‰§è¡Œ `icacls.exe service /remove:d Everyone` åæ‰‹åŠ¨åˆ é™¤ service æ–‡ä»¶å¤¹ï¼Œé‡å¯ APP å³å¯

#### macOS

* æ‰“å¼€ç»ˆç«¯
* è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```
curl https://gist.githubusercontent.com/Fndroid/2119fcb5ccb5a543a8f6a609418ae43f/raw/ff63615309a9b3f3e1d682fc29bc73284816422e/mac.sh > cfw-tun.sh && chmod +x cfw-tun.sh && sudo ./cfw-tun.sh install && rm cfw-tun.sh
```

å¦‚è¦å¸è½½åˆ™å°† install æ”¹ä¸º uninstall

#### linux

å‚è€ƒ(opens new window)

## macOS ç‰ˆæœ¬å¯åŠ¨è¦æ±‚æˆæƒ

åœ¨ç¬¬ä¸€æ¬¡æˆ–æ›´æ–° APP åæ‰“å¼€è½¯ä»¶ä¼šæç¤ºç”¨æˆ·æˆæƒï¼Œè¿™æ˜¯å› ä¸ºéœ€è¦å®‰è£…/æ›´æ–°ç”¨äºè®¾ç½®ç³»ç»Ÿä»£ç†çš„å·¥å…·ï¼Œå¦‚æœä¸è¿›è¡Œæˆæƒï¼ŒGeneral ä¸­çš„ System Proxy å¼€å…³å°†æ— æ³•æ‰“å¼€ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé™¤éå·¥å…·æ›´æ–°ï¼Œå¦åˆ™é™¤äº†ç¬¬ä¸€æ¬¡å¯åŠ¨å¤–ä¸ä¼šé‡å¤éœ€è¦æˆæƒã€‚

## macOS DMG å®‰è£…åæ— æ³•æ‰“å¼€ï¼Œæç¤ºæŸå

ç½‘ç»œä¸‹è½½åº”ç”¨è¢« Apple æ·»åŠ éš”ç¦»æ ‡è¯†ï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤è§£é™¤å³å¯ï¼š

```
sudo xattr -r -d com.apple.quarantine /Applications/Clash\ for\ Windows.app
```

ç³»ç»Ÿä»£ç†è‡ªåŠ¨å…³é—­æˆ–æ‰“å¼€
å‚è€ƒ(opens new window)

General ç«¯å£æ˜¾ç¤ºä¸º 0
å‚è€ƒ(opens new window)

Killer ç³»åˆ—ç½‘å¡æ— æ³•å¼€å¯ TAP/TUN æ¨¡å¼
å‚è€ƒ(opens new window)

# åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ system ä½œä¸º TUN stack æ—¶ï¼ŒClash ç½‘å¡æ— æ³•æ­£å¸¸å·¥ä½œ

è¯·åœ¨ç³»ç»Ÿé˜²ç«å¢™ä¸­å°† clash core æ”¾è¡Œã€‚æ–¹æ³•å‚è€ƒ TUN æ¨¡å¼è¯´æ˜(opens new window)

# åœ¨ Windows ç³»ç»Ÿä¸­ï¼ŒTUN æ¨¡å¼ä¸‹æ— æ³•ä½¿ç”¨çƒ­ç‚¹åˆ†äº«åŠŸèƒ½

* å¼€å¯çƒ­ç‚¹åˆ†äº«åŠŸèƒ½ï¼Œæ­¤æ—¶ç³»ç»Ÿç½‘ç»œè®¾ç½®ä¸­ä¼šç”Ÿæˆä¸€ä¸ªç½‘å¡
* å¼€å¯ TUN æ¨¡å¼
* è¿›å…¥ç³»ç»Ÿç½‘ç»œè®¾ç½®ï¼Œåœ¨ Clash ç½‘å¡å³é”®é€‰æ‹©å±æ€§ï¼Œé€‰æ‹©å…±äº«æ ‡ç­¾é¡µ
* å‹¾é€‰â€œå…è®¸å…¶ä»–ç½‘ç»œç”¨æˆ·é€šè¿‡æ­¤è®¡ç®—æœºçš„ Internet è¿æ¥æ¥è¿æ¥â€
* åœ¨â€œå®¶åº­ç½‘ç»œè¿æ¥â€é€‰æ‹©æ¡†ä¸­é€‰æ‹©ç¬¬ 1 æ­¥ç”Ÿæˆçš„ç½‘å¡

## è½¯ä»¶å¯åŠ¨æ—¶ï¼ŒTUN åˆ›å»ºç½‘å¡å¤±è´¥ï¼Œæç¤º Start Tun interface error: error creating interface: Cannot create a file when that file already exists.ï¼ˆWindowsï¼‰

ä¸´æ—¶è§£å†³æ–¹æ³•ï¼š

* è¿›å…¥ Home Directory
* ç¼–è¾‘ config.yamlï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š

```
port: 7890
# ...
# æ·»åŠ ä¸‹é¢è¿™æ®µğŸ‘‡
tun:
  enable: true
  stack: gvisor
  auto-route: false
  auto-detect-interface: true
```

* é‡å¯ CFW

## ä¸ºä»€ä¹ˆæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬å Service Mode åé¢çš„åœ°çƒå˜çº¢äº†ï¼Ÿ

åœ¨æ›´æ–°åˆ° `v0.20.0` åï¼Œ `Service Mode` çš„å®‰å…¨æ€§æœ‰æ‰€æé«˜ï¼Œå› æ­¤åœ¨ä» `v0.19.29` åŠä»¥ä¸‹ç‰ˆæœ¬æ›´æ–°åˆ°æ­¤ç‰ˆæœ¬æ—¶, `Service Mode` åé¢çš„åœ°çƒå›¾æ ‡å¯èƒ½ä¼šæ˜¾ç¤ºä¸ºçº¢è‰²ï¼Œè¯·åœ¨ Manage ä¸­é€‰æ‹© `Update` æˆ–é‡æ–°å®‰è£… TUN ç½‘å¡æ¥æ¶ˆé™¤æ­¤é—®é¢˜